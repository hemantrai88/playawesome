<div class="card z-depth-1 top-card-fixed teal lighten-2">
    <div class="card-content top-card-content">
        <div class="top-card">
            <h4 class="ds-ib top-card-title">Factory</h4><span class="top-card-title-subtext">Roll your owns</span>
        </div>
    </div>
</div>


<div class="sub-page-div">
	<div class="row">
        <div class="col offset-s1 s10">

           <ul class="factory-list collapsible collapsible-accordion" data-collapsible="accordion">
		    <li>
		      <div class="collapsible-header factory-list-title"><i class="material-icons">library_music</i>Published Lists</div>
		      <div class="collapsible-body">
		      	<div id="published-list">
				</div>
		      </div>
		    </li>
		    <li>
		      <div class="collapsible-header factory-list-title"><i class="material-icons">library_music</i>Draft Lists</div>
		      <div class="collapsible-body"><p>Lorem ipsum dolor sit amet.</p></div>
		    </li>
		    <li>
		      <div class="collapsible-header factory-list-title  active"><i class="material-icons">library_music</i>Create New</div>
		      <div class="collapsible-body">
		      	<form>
		      		<div class="row">
    <form class="col s12">
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">label_outline</i>
          <input id="plName" class="plName" type="text" class="validate">
          <label for="plName">Name it</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">description</i>
          <textarea id="plDescription" class="plDescription materialize-textarea"></textarea>
          <label for="plDescription">Describe it</label>
        </div>
      </div>
      <div class="row">
	    <div class="file-field input-field col s12">
	      <input class="file-path validate cover-upload-field" type="text"/>
	      <div class="btn cover-upload-button">
	        <i class="material-icons prefix cover-upload-icon">airplay</i>
	        <span class="cover-upload-label">
	        	Upload cover
	        </span>
	        <input type="file" class="cover-image-file" />
	      </div>
	    </div>
	  </div>
      <div class="row">
        <div class="input-field col s12">
          <i class="material-icons prefix">label_outline</i>
          <input id="plTagTrigger" class="plTagTrigger" type="text" class="validate">
          <label for="plTagTrigger">Tag it</label>
        </div>
      </div>
      <div class="row">
		<div class="col offset-s1 s5">      	
	        <div class="collection">
	        <a href="#!" class="collection-item">Alvin</a>
	      </div>
	    </div>  
	    <div class="col s5">
	    	<div style="background-color: red;">
	    		
	    	</div>
	    </div>
      </div>
    <div class="row"></div>

    </form>
  </div>
		      		
		      	</form>
		      </div>
		    </li>
		  </ul>

        </div>
      </div>
</div>

<script type="text/javascript">
	$('.collapsible').collapsible({
      accordion : false // A setting that changes the collapsible behavior to expandable instead of the default accordion style
    });

	var data = {
				"request": "latest_playlists"
				};
	data = $.param(data);
	$.ajax({
		type: "POST",
		dataType: "json",
		url: "../api/lists", 
		data: data,
		success: function(data) {
			var list_count = data.results;

			var list_body = '<div class="row">';
			_.each(data, function(playlist, index){
				if(_.isObject(playlist)){
					index++;

					list_body += '<div class="col s3">';
					list_body += '	<div class="card '+playlist.id+'">';
			    	list_body += '		<div class="card-image waves-effect waves-block waves-light">';
					list_body += '			<img class="'+playlist.id+'" src="'+playlist.cover+'">';
			    	list_body += '		</div>';
				    list_body += '		<div class="card-content text-small">';
				    list_body += '  		<div class="center-align"><span class="card-title '+playlist.id+' grey-text text-darken-4 text-small font-125">'+playlist.title+'</span></div>';
				    list_body += '  		<div class="center-align"><p><a href="'+playlist.link+'"><i class="material-icons top-align no-margin-right">perm_identity</i>'+playlist.link_text+'</a></p></div>';
				    list_body += '		</div>';
			  		list_body += '	</div>';
					list_body += '</div>';

					if(index%4==0 && index !== list_count){
						list_body += '</div> <div class="row">'
					}else if(index%4==0 && index === list_count){
						list_body += '</div> <div class="row">'
					}else if(index === list_count){
						list_body += '</div';
					}
					$('#published-list').html(list_body);

				}
			});
		}
	});

	$('#plTagTrigger').keyup(function(){

		var tagTrigger = $('#plTagTrigger').val();
		
		var tagObj = {};

		tagObj.tagTrigger = tagTrigger;
		$.ajax({
			type: "POST",
			dataType: "json",
			url: "../api/tagSearch", 
			data: tagObj,
			success: function(data) {
			}
		});
	});

	$(document).ready(function(){
		$.ajax({
			type: "POST",
			dataType: "json",
			url: "../api/tagList", 
			success: function(data) {
				_.each(data, function(d){
					var o = Object.keys(d);
					var v = Object.value(d);
					console.log(d.o);
				});
			}
		});
	});

</script>